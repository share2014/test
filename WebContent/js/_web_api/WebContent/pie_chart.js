var STR_SECTOR_CLR="99ff00,ff6666,0099ff,ff99ff,ffff99,99ffff,669900,009999,990099,ff9966,9966ff,0000ff,00cc00,ff00ff,bbbbbb,66ccff,cc9966,6699cc,ffcc99,ffcccc,ff0000,ddcc00,00ccdd,cc00dd,3399cc,006666,666600,ffcc60,0066fc";function PieObject(a,b,c){this.caption=c?c:"";this.width=a?a:200;this.height=b?b:200;this.Data=[];this.Marker=[];this.addData=_addPieData;this.setDataByStr=_setPieDataByStr;this.getVmlText=_getVmlText;this.draw=_drawPieObject}
function _addPieData(a,b){this.Data[this.Data.length]=a;this.Marker[this.Marker.length]=b}function _setPieDataByStr(a){this.Data=[];this.Marker=[];for(var a=a.split(","),b=0;b<a.length;b+=2)this.addData(parseFloat(a[b]),a[b+1])}
function _getSectorCode(a,b,c){var d="";180<parseInt(b)-parseInt(a)?d=_getSectorCode(a,a+180,c)+_getSectorCode(a+180,b,c):(d+='<v:PolyLine  strokecolor="'+c+'" fillcolor="'+c+'" points="2500,2500 '+(2500+2500*Math.cos(a/180*Math.PI))+","+(2500+2500*Math.sin(a/180*Math.PI))+" "+(2500+2500*Math.cos(b/180*Math.PI))+","+(2500+2500*Math.sin(b/180*Math.PI))+' 2500,2500"/>',d+='<v:arc strokecolor="'+c+'" fillcolor="'+c+'" style="position:absolute;left:0;top:0;width:5000px;height:5000px;" StartAngle="'+(a+
90)+'" EndAngle="'+(b+90)+'" /> ');return d}function _getPieCode(a,b,c,d){var g=STR_SECTOR_CLR.split(",");null==d&&(d=parseInt(g.length*Math.random())%g.length);for(var a='<v:group fillcolor="red" style="width:'+a+"px;height:"+b+'px;" coordsize="5000,5000">',f=b=0;f<c.length;f++)b+=parseFloat(c[f]);if(0==b)return"";for(var h=0,f=0;f<c.length;f++)var e=360*(parseFloat(c[f])/b),a=a+_getSectorCode(h,h+e,"#"+g[(f+d)%g.length]),h=h+e;return a+"</v:group>"}
function _getMarkerCode(a,b,c,d){var g='<table style="font-size:9pt;">',f=STR_SECTOR_CLR.split(",");null==c&&(c=parseInt(f.length*Math.random())%f.length);d||(d=1);for(var h=0,e=0;e<a.length;e++)h+=parseFloat(a[e]);0==h&&(h=100);for(e=0;e<b.length;e++)0==e%d&&(g+="<tr>"),g+='<td><div style="width:12px;height:12px;font-size:1px;background:#'+f[(e+c)%f.length]+';">&nbsp;</div>',g+="<td><nobr>"+b[e].replace(/</g,"&lt;").replace(/>/g,"&gt;")+"(\u5171"+a[e]+",\u5360"+Math.round(1E3*parseFloat(a[e])/h)/
10+"%)</nobr>";return g+"</table>"}function _getVmlText(a,b,c){var d=STR_SECTOR_CLR.split(",");null==a&&(a=parseInt(d.length*Math.random())%d.length);return'<table><caption style="font-size:10pt;">'+this.caption+"</caption><tr><td>"+_getPieCode(parseInt(this.width),parseInt(this.height),this.Data,a)+(1==b?"<tr>":"")+"<td vAlign=top>"+_getMarkerCode(this.Data,this.Marker,a,c)+"</table>"}function _drawPieObject(a,b,c){document.write(this.getVmlText(a,b,c))};
