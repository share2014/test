var _TLB_IMG_DIR=$api._libaray_path+"/images";
document.write('<style type="text/css">.toolbar_bg{background:url('+_TLB_IMG_DIR+"/toolbar_bg.jpg);}.borderup{border-left:solid #ffffff 1px;border-top:solid #ffffff 1px;border-right:solid #828486 1px;border-bottom:solid #828486 1px;}.borderdown{border-left:solid #848286 1px;border-top:solid #848286 1px;border-right:solid #ffffff 1px;border-bottom:solid #ffffff 1px;}.borderflat{border:solid buttonface 1px;}.borderup_no,.borderdown_no,.borderflat_no,.noborder{border:none;}.editor{background:url("+_TLB_IMG_DIR+
"/editor_toolbar.gif) top left;}.cut{background-repeat:no-repeat;background-position:0 0;width:16px;height:16px}.copy{background-repeat:no-repeat;background-position:-16px 0;width:16px;height:16px}.paste{background-repeat:no-repeat;background-position:-32px 0;width:16px;height:16px}.undo{background-repeat:no-repeat;background-position:-48px 0;width:16px;height:16px}.redo{background-repeat:no-repeat;background-position:-64px 0;width:16px;height:16px}.bold{background-repeat:no-repeat;background-position:-80px 0;width:16px;height:16px}.italic{background-repeat:no-repeat;background-position:-96px 0;width:16px;height:16px}.underline{background-repeat:no-repeat;background-position:-112px 0;width:16px;height:16px}.s{background-repeat:no-repeat;background-position:-128px 0;width:16px;height:16px}.font{background-repeat:no-repeat;background-position:-144px 0;width:16px;height:16px}.fgcolor{background-repeat:no-repeat;background-position:-160px 0;width:16px;height:16px}.bgcolor{background-repeat:no-repeat;background-position:-176px 0;width:16px;height:16px}.left{background-repeat:no-repeat;background-position:-192px 0;width:16px;height:16px}.center{background-repeat:no-repeat;background-position:-208px 0;width:16px;height:16px}.right{background-repeat:no-repeat;background-position:-224px 0;width:16px;height:16px}.numlist{background-repeat:no-repeat;background-position:-240px 0;width:16px;height:16px}.bullist{background-repeat:no-repeat;background-position:-256px 0;width:16px;height:16px}.outdent{background-repeat:no-repeat;background-position:-272px 0;width:16px;height:16px}.indent{background-repeat:no-repeat;background-position:-288px 0;width:16px;height:16px}.sup{background-repeat:no-repeat;background-position:-304px 0;width:16px;height:16px}.sub{background-repeat:no-repeat;background-position:-320px 0;width:16px;height:16px}.removefmt{background-repeat:no-repeat;background-position:-336px 0;width:16px;height:16px}.removelink{background-repeat:no-repeat;background-position:-352px 0;width:16px;height:16px}.remove_word_format{background-repeat:no-repeat;background-position:-368px 0;width:16px;height:16px}.autoformat{background-repeat:no-repeat;background-position:-384px 0;width:16px;height:16px}.prop{background-repeat:no-repeat;background-position:-400px 0;width:16px;height:16px}.insttbl{background-repeat:no-repeat;background-position:0px -18px;width:16px;height:16px}.instrow{background-repeat:no-repeat;background-position:-16px -18px;width:16px;height:16px}.deleterow{background-repeat:no-repeat;background-position:-32px -18px;width:16px;height:16px}.instcol{background-repeat:no-repeat;background-position:-48px -18px;width:16px;height:16px}.deletecol{background-repeat:no-repeat;background-position:-64px -18px;width:16px;height:16px}.instcell{background-repeat:no-repeat;background-position:-80px -18px;width:16px;height:16px}.deletecell{background-repeat:no-repeat;background-position:-96px -18px;width:16px;height:16px}.mrgcell{background-repeat:no-repeat;background-position:-112px -18px;width:16px;height:16px}.spltcell{background-repeat:no-repeat;background-position:-128px -18px;width:16px;height:16px}.cellprop{background-repeat:no-repeat;background-position:-144px -18px;width:16px;height:16px}.tableprop{background-repeat:no-repeat;background-position:-160px -18px;width:16px;height:16px}.specchar{background-repeat:no-repeat;background-position:-176px -18px;width:16px;height:16px}.hr{background-repeat:no-repeat;background-position:-192px -18px;width:16px;height:16px}.anchor{background-repeat:no-repeat;background-position:-208px -19px;width:16px;height:16px}.instimg{background-repeat:no-repeat;background-position:-224px -16px;width:16px;height:17px}.media{background-repeat:no-repeat;background-position:-240px -18px;width:16px;height:16px}.htmledit{background-repeat:no-repeat;background-position:-256px -18px;width:16px;height:16px}.edit{background-repeat:no-repeat;background-position:-272px -18px;width:16px;height:16px}.script{background-repeat:no-repeat;background-position:-288px -18px;width:16px;height:16px}.preview{background-repeat:no-repeat;background-position:-304px -18px;width:16px;height:16px}.paste_no_format{background-repeat:no-repeat;background-position:-321px -20px;width:16px;height:16px}.editor_on{background:url("+
_TLB_IMG_DIR+"/editor_toolbar2.gif) top left;}.cut_on{background-repeat:no-repeat;background-position:0 0;width:16px;height:16px}.copy_on{background-repeat:no-repeat;background-position:-16px 0;width:16px;height:16px}.paste_on{background-repeat:no-repeat;background-position:-32px 0;width:16px;height:16px}.undo_on{background-repeat:no-repeat;background-position:-48px 0;width:16px;height:16px}.redo_on{background-repeat:no-repeat;background-position:-64px 0;width:16px;height:16px}.bold_on{background-repeat:no-repeat;background-position:-80px 0;width:16px;height:16px}.italic_on{background-repeat:no-repeat;background-position:-96px 0;width:16px;height:16px}.underline_on{background-repeat:no-repeat;background-position:-112px 0;width:16px;height:16px}.s_on{background-repeat:no-repeat;background-position:-128px 0;width:16px;height:16px}.font_on{background-repeat:no-repeat;background-position:-144px 0;width:16px;height:16px}.fgcolor_on{background-repeat:no-repeat;background-position:-160px 0;width:16px;height:16px}.bgcolor_on{background-repeat:no-repeat;background-position:-176px 0;width:16px;height:16px}.left_on{background-repeat:no-repeat;background-position:-192px 0;width:16px;height:16px}.center_on{background-repeat:no-repeat;background-position:-208px 0;width:16px;height:16px}.right_on{background-repeat:no-repeat;background-position:-224px 0;width:16px;height:16px}.numlist_on{background-repeat:no-repeat;background-position:-240px 0;width:16px;height:16px}.bullist_on{background-repeat:no-repeat;background-position:-256px 0;width:16px;height:16px}.outdent_on{background-repeat:no-repeat;background-position:-272px 0;width:16px;height:16px}.indent_on{background-repeat:no-repeat;background-position:-288px 0;width:16px;height:16px}.sup_on{background-repeat:no-repeat;background-position:-304px 0;width:16px;height:16px}.sub_on{background-repeat:no-repeat;background-position:-320px 0;width:16px;height:16px}.removefmt_on{background-repeat:no-repeat;background-position:-336px 0;width:16px;height:16px}.removelink_on{background-repeat:no-repeat;background-position:-352px 0;width:16px;height:16px}.remove_word_format_on{background-repeat:no-repeat;background-position:-368px 0;width:16px;height:16px}.autoformat_on{background-repeat:no-repeat;background-position:-384px 0;width:16px;height:16px}.prop_on{background-repeat:no-repeat;background-position:-400px 0;width:16px;height:16px}.insttbl_on{background-repeat:no-repeat;background-position:0px -18px;width:16px;height:16px}.instrow_on{background-repeat:no-repeat;background-position:-16px -18px;width:16px;height:16px}.deleterow_on{background-repeat:no-repeat;background-position:-32px -18px;width:16px;height:16px}.instcol_on{background-repeat:no-repeat;background-position:-48px -18px;width:16px;height:16px}.deletecol_on{background-repeat:no-repeat;background-position:-64px -18px;width:16px;height:16px}.instcell_on{background-repeat:no-repeat;background-position:-80px -18px;width:16px;height:16px}.deletecell_on{background-repeat:no-repeat;background-position:-96px -18px;width:16px;height:16px}.mrgcell_on{background-repeat:no-repeat;background-position:-112px -18px;width:16px;height:16px}.spltcell_on{background-repeat:no-repeat;background-position:-128px -18px;width:16px;height:16px}.cellprop_on{background-repeat:no-repeat;background-position:-144px -18px;width:16px;height:16px}.tableprop_on{background-repeat:no-repeat;background-position:-160px -18px;width:16px;height:16px}.specchar_on{background-repeat:no-repeat;background-position:-176px -18px;width:16px;height:16px}.hr_on{background-repeat:no-repeat;background-position:-192px -18px;width:16px;height:16px}.anchor_on{background-repeat:no-repeat;background-position:-208px -19px;width:16px;height:16px}.instimg_on{background-repeat:no-repeat;background-position:-224px -16px;width:16px;height:17px}.media_on{background-repeat:no-repeat;background-position:-240px -18px;width:16px;height:16px}.htmledit_on{background-repeat:no-repeat;background-position:-256px -18px;width:16px;height:16px}.edit_on{background-repeat:no-repeat;background-position:-272px -18px;width:16px;height:16px}.script_on{background-repeat:no-repeat;background-position:-288px -18px;width:16px;height:16px}.preview_on{background-repeat:no-repeat;background-position:-304px -18px;width:16px;height:16px}.paste_no_format_on{background-repeat:no-repeat;background-position:-321px -20px;width:16px;height:16px}</style>");
var bMSIE=$api.fn._IE(),_JS_TOOLBAR_ID=0,_TLB_BUTTON=0,_TLB_CHECKBOX=1,_TLB_RADIO=2,_TLB_CONTROL=3,_TLB_ARROW=4,_TLB_PRESSED=1,_TLB_UNPRESSED=0;
function Toolbar(){this.tlbButton=_TLB_BUTTON;this.tlbCheckBox=_TLB_CHECKBOX;this.tlbRadio=_TLB_RADIO;this.tlbControl=_TLB_CONTROL;this.tlbArrow=_TLB_ARROW;this.tlbPressed=_TLB_PRESSED;this.tlbUnpressed=_TLB_UNPRESSED;this.id="_JS_TOOLBAR_"+_JS_TOOLBAR_ID++;this.buttons=[];this.addHeader=_addToolbarHeader;this.addButton=_addToolbarButton;this.addSeparator=_addToolbarSeparator;this.addControl=_addToolbarControl;this.addArrow=_addToolbarArrow;this.getButton=_getToolbarButton;this.getHTML=_getHtmlTextOfToolbar}
function ToolbarButton(c,b,a,e,d){this.id=null;this.icon=null!=c?c:"";this.title=null!=b?b:"";this.tiptext=null!=a?a:this.title;this.script=null!=e?e:"";this.style=null!=d?d:_TLB_BUTTON;this.getWidth=_getToolbarButtonWidth;this.setEnabled=_setToolbarButtonEnabled;this.isEnabled=_isToolbarButtonEnabled;this.setState=_setToolbarButtonState;this.getState=_getToolbarButtonState;this.bExpand=!1}
function _addToolbarButton(c){c.id=this.id+"_"+this.buttons.length;return this.buttons[this.buttons.length]=c}function _addToolbarHeader(){this.addButton(new ToolbarButton(null,"||"))}function _addToolbarSeparator(){this.addButton(new ToolbarButton(null,"|"))}function _addToolbarControl(c){this.addButton(new ToolbarButton(null,c,null,null,_TLB_CONTROL))}function _addToolbarArrow(c,b){this.addButton(new ToolbarButton(null,null,c,null,_TLB_ARROW)).bExpand=b}
function _getToolbarButton(c){for(var b=0;b<this.buttons.length;b++)if(this.buttons[b].title==c||this.buttons[b].tiptext==c)return this.buttons[b];return null}
function _getHtmlTextOfToolbar(){for(var c=0,b=!0,a=0;a<this.buttons.length;a++)this.buttons[a].style==_TLB_ARROW&&c++;0!=c%2&&this.addArrow(!1);for(var e=c=0,d="<div id="+this.id+' class=toolbar_bg style="cursor:default;padding:'+(bMSIE?2:0)+"px;height:"+getToolbarHeight()+'px;-moz-user-select:none" onselectstart="return false" oncontextmenu="return false">\n',d=d+"<table cellpadding=0 cellspacing=0><tr>\n",a=0;a<this.buttons.length;a++)this.buttons[a].style==_TLB_CONTROL?d+='<td style="font-size:9pt;padding-left:4px;padding-right:2px;"><nobr>'+
this.buttons[a].title+"</nobr>":this.buttons[a].style==_TLB_ARROW?(c++,1==c%2?(b=this.buttons[a].bExpand,d+='<td style="font-size:1pt;padding-left:2px;display:'+(b?"none":"")+'"><div id='+this.buttons[a].id+' button_type="'+this.buttons[a].style+'" ObjectType="toolbar_button" style="width:'+(bMSIE?10:8)+"px;height:"+(getToolbarHeight()-(bMSIE?6:9))+"px;padding-top:"+(bMSIE?6:9)+'px;padding-left:2px" class="borderflat_no" onmouseover="this.className=\'borderup_no\'" onmouseout="this.className=\'borderflat_no\'" onmousedown="this.className=\'borderdown_no\'" onmouseup="this.onmouseover(event);_toolbar_right_arrow_onclick(\''+
this.id+'\',event)" title="'+this.buttons[a].tiptext+'"><img src="'+_TLB_IMG_DIR+'/right_arrow.gif" align=absmiddle width=4 height=7></div>'):(d+='<td style="font-size:1pt;padding-left:2px;display:'+(b?"":"none")+'"><div id='+this.buttons[a].id+' button_type="'+this.buttons[a].style+'" ObjectType="toolbar_button" style="width:'+(bMSIE?10:8)+"px;height:"+(getToolbarHeight()-(bMSIE?6:9))+"px;padding-top:"+(bMSIE?6:9)+'px;padding-left:2px" class="borderflat_no" onmouseover="this.className=\'borderup_no\'" onmouseout="this.className=\'borderflat_no\'" onmousedown="this.className=\'borderdown_no\'" onmouseup="this.onmouseover(event);_toolbar_left_arrow_onclick(\''+
this.id+'\',event)" title="'+this.buttons[a].tiptext+'"><img src="'+_TLB_IMG_DIR+'/left_arrow.gif" align=absmiddle width=4 height=7></div>',b=!0)):(d+='<td style="width:1px;font-size:1px;display:'+(b?"":"none")+'">&nbsp;',"|"==this.buttons[a].title?(d+='<td style="font-size:1px;display:'+(b?"":"none")+'">'+(bMSIE?'<span style="width:1px;height:'+(getToolbarHeight()-6)+'px;" class=borderdown_no></span>':'<img src="'+_TLB_IMG_DIR+'/point.gif" class=borderdown_no height='+(getToolbarHeight()-6)+" width=0>"),
e++):"||"==this.buttons[a].title?(d+='<td style="font-size:1px;display:'+(b?"":"none")+'"><nobr>'+(bMSIE?'<span style="width:1px;height:'+(getToolbarHeight()-6)+'px;" class=borderup_no></span>':'<img src="'+_TLB_IMG_DIR+'/point.gif" class=borderup_no height='+(getToolbarHeight()-6)+" width=0>")+'<span style="width:1px;height:'+(getToolbarHeight()-6)+'px;" ></span>'+(bMSIE?'<span style="width:1px;height:'+(getToolbarHeight()-6)+'px;" class=borderup_no></span>':'<img src="'+_TLB_IMG_DIR+'/point.gif" class=borderup_no height='+
(getToolbarHeight()-6)+" width=0>")+"</nobr>\n",e++):(d+='<td style="display:'+(b?"":"none")+'"><div id='+this.buttons[a].id+' button_type="'+this.buttons[a].style+'" ObjectType="toolbar_button" style="font-size:9pt;width:'+this.buttons[a].getWidth()+';padding:1px;" class="borderflat_no" align=center title="'+this.buttons[a].tiptext+'" ',d+=' onmouseover="_toolbarbutton_onmouseover(null,event)" onmouseout="_toolbarbutton_onmouseout(null,event)" onmousedown="_toolbarbutton_onmousedown(null,event)" onmouseup="_toolbarbutton_onmouseup(null,event)" ',
d+=" GroupID="+e+' EnabledState="1" ButtonCommand="'+this.buttons[a].script+'"><nobr>',this.buttons[a].icon&&(d=-1!=this.buttons[a].icon.indexOf(".gif")||-1!=this.buttons[a].icon.indexOf(".jpg")?d+('<img src="'+this.buttons[a].icon+'" width=16 height=16 align=absmiddle> '):d+('<span class="editor '+this.buttons[a].icon+"\" onmouseover=\"this.className=this.className.replace('editor','editor_on')+'_on';\" onmouseout=\"this.className=this.className.replace('editor_on','editor').replace('_on','')\"><img src=\""+
_TLB_IMG_DIR+'/blank.gif" width=16 height=16 align=absmiddle></span>')),null!=this.buttons[a].title&&""!=this.buttons[a].title&&(d=bMSIE?d+('<button style="position:relative;height:16px;top:1px;border:none;background:none;width:'+(this.buttons[a].getWidth()-(this.buttons[a].icon?0:16)-20)+'px">'+this.buttons[a].title+"</button>"):d+('<span style="position:relative;top:1px;">'+this.buttons[a].title+"</span>")),d+="</nobr></div>\n"));return d+=(0==this.buttons.length?"<td>&nbsp;":"")+"</table></div>"}
function _getToolbarButtonWidth(){if(this.style==_TLB_CONTROL)return 0;for(var c=0,b=this.title,a=0;a<b.length;a++)c=128<b.charCodeAt(a)?c+15:c+7;null!=this.icon&&""!=this.icon&&(c+=16,""!=b&&(c+=6));return c}
function _toolbarbutton_onmouseover(c,b){var a=null;if(null==c)for(a=bMSIE?event.srcElement:b.target;"toolbar_button"!=a.getAttribute("ObjectType","");)a=a.parentNode;else a=document.getElementById(c);if("0"!=a.getAttribute("EnabledState","1"))if(parseInt(a.getAttribute("button_type",""))==_TLB_BUTTON)a.className="borderup_no";else if((parseInt(a.getAttribute("button_type",""))==_TLB_RADIO||parseInt(a.getAttribute("button_type",""))==_TLB_CHECKBOX)&&"borderflat_no"==a.className)a.className="borderup_no"}
function _toolbarbutton_onmouseout(c,b){var a=null;if(null==c)for(a=bMSIE?event.srcElement:b.target;"toolbar_button"!=a.getAttribute("ObjectType","");)a=a.parentNode;else a=document.getElementById(c);"0"!=a.getAttribute("EnabledState","1")&&(parseInt(a.getAttribute("button_type",""))==_TLB_BUTTON?a.className="borderflat_no":"borderup_no"==a.className&&(a.className="borderflat_no"))}
function _toolbarbutton_onmousedown(c,b){var a=null;if(null==c)for(a=bMSIE?event.srcElement:b.target;"toolbar_button"!=a.getAttribute("ObjectType","");)a=a.parentNode;else a=document.getElementById(c);"0"!=a.getAttribute("EnabledState","1")&&(parseInt(a.getAttribute("button_type",""))==_TLB_BUTTON?a.className="borderdown_no":parseInt(a.getAttribute("button_type",""))==_TLB_RADIO?(a.className="borderdown_no",a.style.backgroundImage="url("+_TLB_IMG_DIR+"/dot.gif)",_onRadioButtonDown(a.id)):parseInt(a.getAttribute("button_type",
""))==_TLB_CHECKBOX&&(a.setAttribute("oldState","borderdown_no"==a.className?"1":"0"),a.className="borderflat_no"))}function _onRadioButtonDown(c){for(var b=c=document.getElementById(c);"TABLE"!=b.tagName;)b=b.parentNode;for(var b=b.getElementsByTagName("DIV"),a=0;a<b.length;a++)if(!("toolbar_button"!=b[a].getAttribute("ObjectType")||b[a].getAttribute("GroupID")!=c.getAttribute("GroupID")||b[a]==c)&&"borderdown_no"==b[a].className)b[a].className="borderflat_no",b[a].style.background=""}
function _toolbarbutton_onmouseup(c,b){if(!b||!(1!=b.button&&bMSIE)){var a=null;if(null==c)for(a=bMSIE?event.srcElement:b.target;"toolbar_button"!=a.getAttribute("ObjectType","");)a=a.parentNode;else a=document.getElementById(c);if("0"!=a.getAttribute("EnabledState","1")){parseInt(a.getAttribute("button_type",""))==_TLB_BUTTON?a.className="borderup_no":parseInt(a.getAttribute("button_type",""))==_TLB_CHECKBOX&&("1"==a.getAttribute("oldState","0")?(a.className="borderup_no",a.style.background=""):
(a.className="borderdown_no",a.style.backgroundImage="url("+_TLB_IMG_DIR+"/dot.gif)"));var e=a.getAttribute("ButtonCommand","");e&&(window.setTimeout("_toolbarbutton_onmouseout('"+a.id+"')",500),eval(e))}}}
function _toolbar_right_arrow_onclick(c,b){for(var a=null,e=null,d=bMSIE?b.srcElement:b.target;d&&"TD"!=d.tagName;)d=d.parentNode;for(var g=document.getElementById(c).getElementsByTagName("TABLE")[0].getElementsByTagName("TD"),h=!1,f=0;f<g.length;f++)if(e=g[f],e==d)h=!0;else if(h){if(0!=e.getElementsByTagName("DIV").length&&(a=e.getElementsByTagName("DIV")[0],a=a.getAttribute("button_type"),null!=a&&parseInt(a)==_TLB_ARROW)){e.style.display="";break}e.style.display=""}d.style.display="none"}
function _toolbar_left_arrow_onclick(c,b){for(var a=null,e=null,d=bMSIE?b.srcElement:b.target;d&&"TD"!=d.tagName;)d=d.parentNode;for(var g=document.getElementById(c).getElementsByTagName("TABLE")[0].getElementsByTagName("TD"),h=!1,f=g.length-1;0<f;f--)if(e=g[f],e==d)h=!0;else if(h){if(0!=e.getElementsByTagName("DIV").length&&(a=e.getElementsByTagName("DIV")[0],a=a.getAttribute("button_type"),null!=a&&parseInt(a)==_TLB_ARROW)){e.style.display="";break}e.style.display="none"}d.style.display="none"}
function _setToolbarButtonEnabled(c){var b=c?"1":"0",a=document.getElementById(this.id);a&&a.getAttribute("EnabledState")!=b&&(a.getElementsByTagName("IMG"),c?(a.style.color="",a.className=this.style!=_TLB_BUTTON?a.getAttribute("oldClassName"):"borderflat_no",a.style.padding="1",1==a.getElementsByTagName("BUTTON").length&&(a.getElementsByTagName("BUTTON")[0].disabled=!1)):(a.style.color="gray",a.setAttribute("oldClassName",a.className),a.className="noborder",a.style.padding="2",1==a.getElementsByTagName("BUTTON").length&&
(a.getElementsByTagName("BUTTON")[0].disabled=!0)),a.setAttribute("EnabledState",b))}function _isToolbarButtonEnabled(){return"1"==document.getElementById(this.id).getAttribute("EnabledState","1")}
function _setToolbarButtonState(c){if(!(this.style!=_TLB_RADIO&&this.style!=_TLB_CHECKBOX||this.getState()==c)){var b=document.getElementById(this.id);c==_TLB_UNPRESSED?(b.className="borderflat_no",b.style.backgroundImage=""):(b.className="borderdown_no"==b.className?"borderflat_no":"borderdown_no",b.style.backgroundImage="borderflat_no"==b.className?"":"url("+_TLB_IMG_DIR+"/dot.gif)",this.style==_TLB_RADIO&&_onRadioButtonDown(this.id))}}
function _getToolbarButtonState(){return this.style!=_TLB_RADIO&&this.style!=_TLB_CHECKBOX?_TLB_UNPRESSED:"borderdown_no"==document.getElementById(this.id).className?_TLB_PRESSED:_TLB_UNPRESSED}function getToolbarHeight(){return bMSIE?28:26};
