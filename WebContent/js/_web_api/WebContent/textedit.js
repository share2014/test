function insertAtCursor(a,b){if(document.selection)a.focus(),sel=document.selection.createRange(),sel.text=b,sel.select();else if(a.selectionStart||"0"==a.selectionStart){var c=a.selectionStart,e=a.selectionEnd,d=a.scrollTop;a.value=a.value.substring(0,c)+b+a.value.substring(e,a.value.length);0<d&&(a.scrollTop=d);a.focus();a.selectionStart=c+b.length;a.selectionEnd=c+b.length}else a.value+=b,a.focus()}
function getSelectedText(a){if(document.selection)return a.focus(),document.selection.createRange().text;if(a.selectionStart||"0"==a.selectionStart){var b=a.selectionStart,c=a.selectionEnd;a.focus();return a.value.substring(b,c)}a.focus();return a.value};
