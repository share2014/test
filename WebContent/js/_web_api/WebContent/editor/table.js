function insertRow(){var a=getElementByTagName("TR");if(a)for(var e=a.parentNode.parentNode.insertRow(a.rowIndex),c=0;c<a.cells.length;c++)e.insertCell(c).colSpan=a.cells[c].colSpan}function deleteRow(){var a=getElementByTagName("TR");a&&a.parentNode.parentNode.deleteRow(a.rowIndex)}
function insertCol(){var a=getElementByTagName("TD");if(a){for(var e=a.parentNode,c=e.parentNode.parentNode,f=0,g=0,b=0;b<a.cellIndex;b++)f+=e.cells[b].colSpan;for(b=0;b<c.rows.length;b++)for(a=g=0;a<c.rows[b].cells.length;a++){g>f?c.rows[b].cells[a].colSpan=c.rows[b].cells[a].colSpan+g-f:g==f&&c.rows[b].insertCell(a);if(g>=f)break;g+=c.rows[b].cells[a].colSpan}}}
function deleteCol(){var a=getElementByTagName("TD");if(a){for(var e=a.parentNode,c=e.parentNode.parentNode,f=0,g=0,b=0;b<=a.cellIndex;b++)f+=e.cells[b].colSpan;for(b=0;b<c.rows.length;b++)for(a=g=0;a<c.rows[b].cells.length&&!(g+=c.rows[b].cells[a].colSpan,g>f?c.rows[b].cells[a].colSpan-=g-f:g==f&&c.rows[b].deleteCell(a),g>=f);a++);}}function insertCell(){var a=getElementByTagName("TD");a&&a.parentNode.insertCell(a.cellIndex)}
function deleteCell(){var a=getElementByTagName("TD");a&&a.parentNode.deleteCell(a.cellIndex)}
function mergeCell(a){var e=getElementByTagName("TD");if(e){var c=e.parentNode,f=c.parentNode.parentNode;if(a||showFrameDialog($wapper.api.getParentPath()+"/merge_cell.htm","\u5408\u5e76\u5355\u5143\u683c","dialogWidth:240px;dialogHeight:160px",null,"mergeCell(true)")){a=getReturnValue().split("\n");0>parseInt(a[0])&&(a[0]="0");0>parseInt(a[1])&&(a[1]="0");for(var g="",b=c.rowIndex+parseInt(a[1]);b>=c.rowIndex;b--){for(var d=e.cellIndex+parseInt(a[0]);d>=e.cellIndex;d--)g=f.rows[b].cells[d].innerHTML+
g,e!=f.rows[b].cells[d]&&(c.rowIndex==b&&(e.colSpan+=f.rows[b].cells[d].colSpan),e.cellIndex==d&&(e.rowSpan+=f.rows[b].cells[d].rowSpan),f.rows[b].deleteCell(d));b>c.rowIndex&&(g="<br>"+g)}e.innerHTML=g}}}
function splitCell(a){var e=getElementByTagName("TD");if(e){var c=e.parentNode,f=c.parentNode.parentNode;if(a||showFrameDialog($wapper.api.getParentPath()+"/split_cell.htm","\u62c6\u5206\u5355\u5143\u683c","dialogWidth:280px;dialogHeight:180px",null,"splitCell(true)"))if(a=getReturnValue().split("\n"),"0"==a[0]){for(var g=0,b=0,d=0;d<=e.cellIndex;d++)g+=c.cells[d].colSpan;for(d=0;d<parseInt(a[1])-1;d++)c.insertCell(e.cellIndex+1);for(d=0;d<f.rows.length;d++)if(d!=c.rowIndex)for(e=b=0;e<f.rows[d].cells.length;e++)if(b+=
f.rows[d].cells[e].colSpan,b>=g){f.rows[d].cells[e].colSpan=f.rows[d].cells[e].colSpan+parseInt(a[1])-1;break}}else if("0"==a[1]){for(d=0;d<parseInt(a[0])-1;d++)f.insertRow(c.rowIndex+1).insertCell(0);for(d=0;d<c.cells.length;d++)e!=c.cells[d]&&(c.cells[d].rowSpan=c.cells[d].rowSpan+parseInt(a[0])-1)}}};
